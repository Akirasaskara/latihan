generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  MAHASISWA
}

enum JenisKelamin {
  L
  P
}
model User {
  id          Int        @id @default(autoincrement())
  username    String     @unique
  password    String
  role        Role

  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
    mahasiswa   Mahasiswa?
}

model Dosen {
  nidn          Int          @id
  nama_dosen    String
  jenis_kelamin JenisKelamin
  alamat        String
  matakuliah    Matakuliah[]

  penjadwalans Penjadwalan[]
}

model Matakuliah {
  id_matakuliah Int           @id
  nama_matakuliah String
  id_dosen      Int
  sks           Int
  dosen         Dosen         @relation(fields: [id_dosen], references: [nidn])
  penjadwalan   Penjadwalan[]
}

model Mahasiswa {
  id             Int        @id @default(autoincrement())
  nim            String     @unique
  nama_mahasiswa String
  jenis_kelamin  JenisKelamin
  jurusan        String
  userId        Int?       @unique


  user          User?       @relation(fields: [userId], references: [id])
  krs            KRS[]
}

model Penjadwalan {
  id            Int          @id @default(autoincrement())
  id_dosen      Int
  id_matakuliah Int
  jadwal        String

  dosen         Dosen       @relation(fields: [id_dosen], references: [nidn])
  matakuliah    Matakuliah  @relation(fields: [id_matakuliah], references: [id_matakuliah])
  krs           KRS[]
}

model KRS {
  id            Int         @id @default(autoincrement())
  mahasiswaId   Int
  penjadwalanId Int
  tahunAjaran   String
  semester      Int

  mahasiswa     Mahasiswa   @relation(fields: [mahasiswaId], references: [id])
  penjadwalan   Penjadwalan @relation(fields: [penjadwalanId], references: [id])
}